"use strict";(globalThis.webpackChunkblog2=globalThis.webpackChunkblog2||[]).push([[1914],{59804(e,t,n){n.r(t),n.d(t,{assets:()=>h,contentTitle:()=>r,default:()=>d,frontMatter:()=>s,metadata:()=>o,toc:()=>l});var o=n(90362),a=n(62615),i=n(10253);const s={title:"Automating npm packages updates with renovate bot on github",tags:["Automation"],date:new Date("2021-08-07T15:57:22.000Z"),authors:["dhbalaji"]},r=void 0,h={authorsImageUrls:[void 0]},l=[{value:"What is the problem which we are trying to solve?",id:"what-is-the-problem-which-we-are-trying-to-solve",level:2},{value:"Problem #1",id:"problem-1",level:3},{value:"Problem #2",id:"problem-2",level:3},{value:"Renovate for Automating version updates",id:"renovate-for-automating-version-updates",level:2},{value:"How to renovate works as a GitHub app",id:"how-to-renovate-works-as-a-github-app",level:3},{value:"Advantages of renovate",id:"advantages-of-renovate",level:2},{value:"Shortcomings",id:"shortcomings",level:2},{value:"Verdict",id:"verdict",level:2}];function c(e){const t={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"react renovate",src:n(92733).A+"",width:"943",height:"728"})}),"\n",(0,a.jsx)(t.p,{children:"In this how to article, I will be discussing how we can set up a GitHub application to automatically keep our npm packages updated without breaking the app. We will also discuss the shortcomings of this application and if it's the right fit for use in production or in a team environment."}),"\n",(0,a.jsx)(t.h2,{id:"what-is-the-problem-which-we-are-trying-to-solve",children:"What is the problem which we are trying to solve?"}),"\n",(0,a.jsxs)(t.p,{children:["Let us start with ",(0,a.jsx)(t.code,{children:"semantic versioning"})," of the npm packages. We have 3 segments in the version number which looks like 17.0.2 (which is the react version at the time of writing this blog post)."]}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Major version"}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Minor version"}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Patch version"}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"Taking the above version 17.0.2 as an example, we have 17 as major, 0 as minor, and 2 as patch version. Let us say react team releases the next major version, then some APIs might be at risk of not working or deprecated. so the developer reads the changelog and chooses between upgrading or continuing with the same version."}),"\n",(0,a.jsx)(t.h3,{id:"problem-1",children:"Problem #1"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"In most teams, the npm packages are not updated regularly which puts the application at security risk, and also the team is missing out on the recent developments in the frameworks like bug fixes and performance improvement. This is a type of tech debt that the team needs to pay from time to time."}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"This problem can be automated. There is a GitHub application for that."}),"\n",(0,a.jsxs)(t.p,{children:["There are other concepts called version drift which is solved by ",(0,a.jsx)(t.code,{children:"package-lock.json"})," which you may read about elsewhere."]}),"\n",(0,a.jsx)(t.h3,{id:"problem-2",children:"Problem #2"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsxs)(t.p,{children:["By default npm will use symbol ",(0,a.jsx)(t.code,{children:"^"})," before the semver version which means that the latest minor change above this semver version will be installed."]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"The issue is that we cannot be sure which version has been installed unless we dig through package-lock.json which the developer has to upload along with the package.json file."}),"\n",(0,a.jsx)(t.h2,{id:"renovate-for-automating-version-updates",children:"Renovate for Automating version updates"}),"\n",(0,a.jsxs)(t.p,{children:["The tool/app which solves the problem of npm package updates is called ",(0,a.jsx)(t.code,{children:"Renovate"})," which is backed by a company called white source."]}),"\n",(0,a.jsx)(t.p,{children:"The tool renovate comes in different flavors"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["As an npm package called ",(0,a.jsx)(t.a,{href:"https://www.npmjs.com/package/renovate",children:"renovate on npm"})]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["As a ",(0,a.jsx)(t.a,{href:"https://github.com/apps/renovate",children:"github application"})," and as an app on similar git platforms."]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"As an on-premise solution which I have not evaluated"}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(t.h3,{id:"how-to-renovate-works-as-a-github-app",children:"How to renovate works as a GitHub app"}),"\n",(0,a.jsx)(t.p,{children:"We have to follow few steps, and you will be ready to go."}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"We assume you have a repo on GitHub which is old enough and needs npm package updates. I had the react-redux production-ready boilerplate project which is at least 6 months old."}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Goto renovate app and select the repo to which renovate will have access. you can give access to all the repositories but I do not see any point given the fact that some of them are forks of other projects which I do not intend to maintain."}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["You will receive a welcome PR from renovating with the config file that will be added to your codebase. Merging this PR means you agree to renovate the app to work with your repo. ",(0,a.jsx)(t.code,{children:"renovate.json"})," file will be added to the codebase after this step."]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["After this step, you will start receiving a bunch of PRs to your repo from ",(0,a.jsx)(t.code,{children:"renovate"}),". Most of the PRs are about pinning the semver version to a specific number and avoid the symbol ",(0,a.jsx)(t.code,{children:"^"}),"."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"renovate PRs github",src:n(77898).A+"",width:"1278",height:"604"})}),"\n",(0,a.jsxs)(t.ol,{start:"5",children:["\n",(0,a.jsx)(t.li,{children:"You can accept or decline the PR. Declining the PR means renovate will no longer work on updating or notifying about the npm package in the future."}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"renovate changelog",src:n(96263).A+"",width:"1269",height:"759"})}),"\n",(0,a.jsxs)(t.ol,{start:"6",children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"I also got a PR to fix my node-engine version."}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"You can configure renovate to send you PRs on a specific day and of course, a lot of customization can be done with their configuration changes."}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["You can use their npm global package to validate the configuration file for errors. It's called the ",(0,a.jsx)(t.code,{children:"renovate-config-validator"})," command after you install ",(0,a.jsx)(t.code,{children:"renovate"})," globally."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"advantages-of-renovate",children:"Advantages of renovate"}),"\n",(0,a.jsxs)(t.p,{children:["I have written about dependabot previously. Dependabot takes care of vulnerability fixes to the npm packages. Renovate does something similar to the\r\nnpm packages by keeping them updated in ",(0,a.jsx)(t.code,{children:"real time"})," for free."]}),"\n",(0,a.jsx)(t.p,{children:"The configuration was straightforward forward and I found the bot to be predictable. The npm-based command to validate renovate config file was great."}),"\n",(0,a.jsx)(t.p,{children:"The same bot can be used for updated other platform tools like PHP compose, python-pip packages. The bot had been updated by the GitHub actions version too."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"renovate actions update",src:n(17298).A+"",width:"930",height:"699"})}),"\n",(0,a.jsx)(t.h2,{id:"shortcomings",children:"Shortcomings"}),"\n",(0,a.jsx)(t.p,{children:"The configurations were not easy to understand at a glance. To check if the config works we need to wait for some package to be updated and we will get a PR with the new configuration applied."}),"\n",(0,a.jsx)(t.p,{children:"I am not sure how to configure on my local or CI after going through their docs. Felt like the docs were rushed (like my blog lol)."}),"\n",(0,a.jsx)(t.p,{children:"There was no explanation/justification about the below PR and why it's happening. The logs did not help me understand why this is important."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"react renovate node engine",src:n(73733).A+"",width:"938",height:"636"})}),"\n",(0,a.jsx)(t.h2,{id:"verdict",children:"Verdict"}),"\n",(0,a.jsx)(t.p,{children:"Overall an easy-to-use bot to keep your npm packages updated. Suitable for GitHub and non-GitHub repositories. Fits the most popular programming lang packages."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"react changelog renovate",src:n(87962).A+"",width:"1235",height:"814"})})]})}function d(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},87962(e,t,n){n.d(t,{A:()=>o});const o=n.p+"assets/images/changelog-renovate-pr-a090a0217f4fbfe7222a70173dc2053e.webp"},73733(e,t,n){n.d(t,{A:()=>o});const o=n.p+"assets/images/node-engine-dc4f8db75f04d7a60baf5a6b0cf4322e.webp"},92733(e,t,n){n.d(t,{A:()=>o});const o=n.p+"assets/images/react-renovate-update-pr-d3ae5685074db47897a605c139155327.webp"},77898(e,t,n){n.d(t,{A:()=>o});const o=n.p+"assets/images/renovate-PRS-c8fcc7d919570445dd830d7730795af0.webp"},17298(e,t,n){n.d(t,{A:()=>o});const o=n.p+"assets/images/renovate-actions-cc1a1298c520b8818809c1cce64b6ab5.webp"},96263(e,t,n){n.d(t,{A:()=>o});const o=n.p+"assets/images/renovate-changelog-73ecb410443363f5fb8e17af09a7e059.webp"},10253(e,t,n){n.d(t,{R:()=>s,x:()=>r});var o=n(59471);const a={},i=o.createContext(a);function s(e){const t=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),o.createElement(i.Provider,{value:t},e.children)}},90362(e){e.exports=JSON.parse('{"permalink":"/blog/Automating-npm-packages-updates-with-renovate-on-github","source":"@site/blog/Automating-npm-packages-updates-with-renovate-on-github.md","title":"Automating npm packages updates with renovate bot on github","description":"react renovate","date":"2021-08-07T15:57:22.000Z","tags":[{"inline":true,"label":"Automation","permalink":"/blog/tags/automation"}],"readingTime":4.51,"hasTruncateMarker":true,"authors":[{"name":"D Balaji","title":"Lead Design Technologist","url":"https://github.com/dhbalaji","imageURL":"https://avatars.githubusercontent.com/u/3672491?v=4","key":"dhbalaji","page":null}],"frontMatter":{"title":"Automating npm packages updates with renovate bot on github","tags":["Automation"],"date":"2021-08-07T15:57:22.000Z","authors":["dhbalaji"]},"unlisted":false,"prevItem":{"title":"Lessons from my 18 months of WFH, checklist","permalink":"/blog/Lessons-from-my-18-months-of-WFH-checklist"},"nextItem":{"title":"Building and distributing lightweight NPM packages for react projects","permalink":"/blog/Building-and-distributing-light-weight-NPM-packages-for-react-projects"}}')}}]);